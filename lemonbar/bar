#!/usr/bin/bash

# Colors

c1="%{B#a93437}"
b="%{B-}"
c2="%{B#362b40}"
c3="%{B#9e3909}"

#
Hora() {
  h=$(date +'%A %d-%m-%Y %I:%M %p')
  echo -e "$c3 $h $b"
}

Wifi() {
  if ping -q -c 1 -W 2 8.8.8.8 >/dev/null; then
    echo "$c1 Connected $b"
  else
    echo "$c1 Disconnected $b"
  fi
}

Batery() {
  BATERY=$(cat /sys/class/power_supply/BATT/capacity)
  STATUS=$(cat /sys/class/power_supply/BATT/status)
  echo "$c2 $BATERY% $STATUS $b"
}

Title() {
  len=$(echo -n "$(xdotool getwindowfocus getwindowname)" | wc -m)
  max_len=70
  if [ "$len" -gt "$max_len" ];then
    echo -n "$(xdotool getwindowfocus getwindowname | cut -c 1-$max_len)..."
  else
    echo -n "$(xdotool getwindowfocus getwindowname)"
  fi
}

while true; do
  echo "%{l} %{c} $(Title) %{r} $(Batery) | $(Wifi) | $(Hora)"
  sleep 5s
done | lemonbar -d -p -f "JetBrains Mono Nerd Font:size=8" -B "#000000" &
